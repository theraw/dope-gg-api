# WHMCS DEV SERVER
    server {
        listen 8443 default_server ssl;
        ssl_protocols       TLSv1.1 TLSv1.2 TLSv1.3;
        ssl_certificate     /nginx/ssl/com.crt;
        ssl_certificate_key /nginx/ssl/com.key;
        proxy_ssl_conf_command Ciphersuites TLS_AES_256_GCM_SHA384;
    
        server_name  localhost;
        index index.html index.php;
        root /opt/www/dopegg/whmcs;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
        location ~* ^.+\.(jpeg|jpg|png|gif|bmp|ico|svg|css|js)$ {
            expires     max;
        }
        location ~ [^/]\.php(/|$) {
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
            if (!-f $document_root$fastcgi_script_name) {
                return  404;
            }
          fastcgi_pass 127.0.0.1:9082;
          fastcgi_buffers 16 256k;
          fastcgi_buffer_size 256k;
          fastcgi_index index.php;
          fastcgi_read_timeout 90;
          fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
          include fastcgi_params;
        }
    }
    location ~ /announcements/?(.*)$ {
        rewrite ^/(.*)$ /index.php?rp=/announcements/$1;
    }
    location ~ /downloads/?(.*)$ {
        rewrite ^/(.*)$ /index.php?rp=/downloads/$1;
    }
    location ~ /knowledgebase/?(.*)$ {
        rewrite ^/(.*)$ /index.php?rp=/knowledgebase/$1;
    }
    include /nginx/config/php72.conf;
    }
